FROM node:18-alpine

RUN apk update && \
    apk add mysql-client

ARG NODE_PORT
ENV NODE_PORT="$NODE_PORT"

ARG DB_PORT
ENV DB_PORT="$DB_PORT"

ARG DB_PASSWORD
ENV DB_PASSWORD="$DB_PASSWORD"

ARG DB_USER
ENV DB_USER="$DB_USER"

ARG DB_DATABASE_NAME
ENV DB_DATABASE_NAME="$DB_DATABASE_NAME"

ARG DB_HOSTNAME
ENV DB_HOSTNAME="$DB_HOSTNAME"

WORKDIR /app

COPY package*.json ./

RUN npm install

COPY . .

EXPOSE $PORT

RUN npm run build

# CMD ["npm","run", "start"]
